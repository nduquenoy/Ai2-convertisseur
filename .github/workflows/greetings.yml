name: ğŸ‰ Interaction & Thanks

on:
  issues:
    types: [opened, closed, reopened]
  pull_request_target:
    types: [opened, closed, reopened]
  push:
    branches: [main]
  discussion:
    types: [created]

jobs:
  greetings:
    runs-on: ubuntu-latest
    permissions:
      issues: write
      pull-requests: write
      discussions: write

    steps:
    - name: ğŸ¤– Welcome Message (First Interaction)
      uses: actions/first-interaction@v1
      with:
        repo-token: ${{ secrets.GITHUB_TOKEN }}
        issue-message: |
          ## ğŸ‘‹ Hello ${{ github.actor }}!
          I'm **Nicolas**, the creator of **AI2 Convert**.

          Today is a big day: you just opened your **first issue** ğŸ¾!

          Thank you for contributing to **AI2 Convert**! Your help is valuable for improving the project.

          Feel free to join the discussion or suggest improvements.

          â€” *Nicolas*
        pr-message: |
          ## ğŸ‘‹ Hi ${{ github.actor }}!
          Thank you for your **first Pull Request** on *AI2 Convert*.

          Your involvement really helps the project grow.  
          If you want, join our community Discord to share ideas!

          â€” *Nicolas*

  thanks:
    runs-on: ubuntu-latest
    if: github.event_name == 'push' || github.event_name == 'pull_request_target'
    permissions:
      contents: write
    steps:
    - name: ğŸ™Œ Thank Contributors
      uses: peter-evans/commit-comment@v3
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        body: |
          ğŸ‘ Thank you **${{ github.actor }}** for your contribution!  
          Every commit counts, and your work on *AI2 Convert* is appreciated ğŸ’«
          
          Keep it up, code adventurer ğŸ±â€ğŸ’»

  labeler:
    runs-on: ubuntu-latest
    if: github.event_name == 'pull_request_target'
    permissions:
      contents: write
    steps:
    - name: ğŸ·ï¸ Add Automatic Labels
      uses: actions-ecosystem/action-add-labels@v1
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        labels: |
          contribution
          awaiting-review

  pr-merge-message:
    runs-on: ubuntu-latest
    if: github.event.pull_request.merged == true
    permissions:
      contents: write
    steps:
    - name: ğŸŠ Congratulate on PR Merge
      uses: actions/github-script@v7
      with:
        github-token: ${{ secrets.GITHUB_TOKEN }}
        script: |
          const pr = context.payload.pull_request;
          const user = pr.user.login;
          const message = `ğŸ‰ Congratulations @${user}! Your Pull Request **${pr.title}** has just been merged into *AI2 Convert* ğŸš€  
          Thank you for your work and contribution to this project! âœ¨`;
          await github.issues.createComment({
            issue_number: pr.number,
            owner: context.repo.owner,
            repo: context.repo.repo,
            body: message
          });
